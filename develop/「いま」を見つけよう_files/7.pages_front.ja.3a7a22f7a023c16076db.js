webpackJsonp([7],{708:function(t,e,i){"use strict";function s(t,e){n(e),p.attachTo(document,e),f.attachTo(document),o.attachTo(document,e),g.attachTo(document,e),d.attachTo(document,e),m.attachTo(document,e),S.attachTo(document,e),e.excludeExpandingTweets||h.attachTo(t,e);var i=".js-new-items-bar-container";u.attachTo(i,e),e.excludeUserActions||v.attachTo(t,w.merge(e,{genericItemSelector:".js-stream-item"})),a.attachTo(document),r.attachTo(document),l.attachTo(document),c.attachTo(document)}var n=i(709),o=i(713),a=i(714),r=i(715),l=i(716),c=i(717),h=i(718),d=i(724),u=i(725),m=i(275),p=i(727),f=i(742),g=i(743),v=i(744),w=i(29),S=i(746);t.exports=s},709:function(t,e,i){function s(t){n.attachTo(document,t),a.attachTo(document,t),o.attachTo(r,t,{initialFocusSelector:".modal-close"})}var n=i(710),o=i(711),a=i(712),r="#activity-popup-dialog";t.exports=s},710:function(t,e,i){function s(){this.defaultAttrs({noShowError:!0}),this.getUsers=function(t,e){var i={retweeted_popup:"/i/activity/retweeted_popup",favorited_popup:"/i/activity/favorited_popup",media_tagged_popup:"/i/activity/media_tagged_popup",reply_users_popup:"/i/tweet/reply_users_popup",like_moment_popup:"/i/moments/user_likes_dialog",people_in_conversation_popup:"/i/tweet/people_in_conversation_popup"}[e.component];this.get({url:i,data:{id:e.contentId},eventData:e,success:"dataActivityPopupSuccess",error:"dataActivityPopupError"})},this.after("initialize",function(){this.on("uiFetchActivityPopup",this.getUsers)})}var n=i(14),o=i(141);t.exports=n(s,o)},711:function(t,e,i){(function(e){function s(){this.defaultAttrs({itemType:"user",titleSelector:".modal-title",contentSelector:".activity-popup-dialog-content",contentShowingSelector:".tweet-showing",userContentSelector:".activity-popup-dialog-users",openDropdownSelector:".user-dropdown.open .dropdown-menu",usersSelector:".activity-popup-users",replyUsersHeadingSelector:".reply-users-heading",activityUserCheckboxSelector:".activity-popup-dialog-users .js-user-checkbox",activityOtherReplyUsersCheckboxSelector:".activity-popup-dialog-other-reply-users .js-other-reply-users-checkbox",accountSelector:".account",saveSelector:".save-action",maxTop:100,modalClasses:{retweeted_popup:"retweeted-popup",favorited_popup:"favorited-popup",media_tagged_popup:"media-tagged-popup",reply_users_popup:"reply-users-popup",like_moment_popup:"like-moment-popup",people_in_conversation_popup:"people-in-conversation-popup"}}),this.setTitle=function(t){this.select("titleSelector").html(t)},this.setContent=function(t,e){this.$node.addClass("has-content");var i=this.select("contentSelector");i.html(t),i.toggleClass(this.attr.contentShowingSelector,!e)},this.setUsers=function(t){this.$node.addClass("has-content"),this.select("userContentSelector").html(t)},this.clearContent=function(){this.$node.removeClass("has-content"),this.select("contentSelector").empty(),this.select("userContentSelector").empty(),this.setTitle("")},this.requestPopup=function(t,e){this.openerNode=t.target,this.excludeReplyUserIds=e.excludeReplyUserIds;var i=e.htmlTitle,s=e.contentId,n=e.component;if(this.attr.eventData=o.merge(this.attr.eventData,{scribeContext:{component:n}},!0),this.defaultEventData=this.attr.eventData,this.attr.modalClasses[n]){this.clearContent();var a=i||"取得中...";this.setTitle(a),Object.keys(this.attr.modalClasses).forEach(function(t){var e=this.attr.modalClasses[t];this.$node.toggleClass(e,t===n)},this),this.open(),this.trigger("uiFetchActivityPopup",{component:n,contentId:s})}},this.updatePopup=function(t,e){this.setTitle(e.htmlTitle),this.setUsers(e.htmlUsers),this.setContent(e.htmlContent),this.trigger("uiActivityPopupRendered"),this.setReplyUsersCheckboxState(this.excludeReplyUserIds);var i=this.select("usersSelector");i.height()>=parseInt(i.css("max-height"),10)&&i.addClass("dropdown-threshold")},this.showError=function(t,i){this.clearContent();var s=e("<p>").addClass("error").html(i.message);this.setUsers(s,!0),this.setTitle("エラーが発生しました。")},this.notifyOpenerDialogClosed=function(){this.trigger(this.openerNode,"uiActivityPopupClosed")},this.setReplyUsersCheckboxState=function(t){t&&(this.select("activityUserCheckboxSelector").each(function(i,s){var n=e(s),o=n.closest(this.attr.accountSelector),a=o.attr("data-user-id");n.prop("checked",t.indexOf(a)<0)}.bind(this)),this.updateExcludeAllCheckboxState())},this.updateExcludeAllCheckboxState=function(){var t=this.select("activityUserCheckboxSelector"),e=t.length===t.filter(":checked").length;this.select("activityOtherReplyUsersCheckboxSelector").prop("checked",e)},this.saveExcludedReplyUsers=function(){var t=this.select("activityUserCheckboxSelector").filter(":not(:checked)").toArray().map(function(t){return e(t).closest(this.attr.accountSelector).attr("data-user-id")},this);this.trigger(this.openerNode,"uiActivityPopupSave",{excludeReplyUserIds:t})},this.toggleAllReplyUsers=function(t){this.select("activityUserCheckboxSelector").prop("checked",e(t.target).prop("checked"))},this.after("initialize",function(){this.on(document,"uiRequestActivityPopup",this.requestPopup),this.on(document,"dataActivityPopupSuccess",this.updatePopup),this.on(document,"dataActivityPopupError",this.showError),this.on(document,"uiShowProfilePopup uiOpenTweetDialogWithOptions uiNeedsDMDialog uiOpenSignupDialog",this.close),this.on("change",{activityUserCheckboxSelector:this.updateExcludeAllCheckboxState,activityOtherReplyUsersCheckboxSelector:this.toggleAllReplyUsers}),this.on("uiDialogClosed",this.saveExcludedReplyUsers),this.on("uiDialogClosed",this.notifyOpenerDialogClosed)})}var n=(i(26),i(14)),o=i(29),a=i(66),r=i(341),l=i(344);t.exports=n(s,a,l,r)}).call(e,i(1))},712:function(t,e,i){function s(){this.scribeActivityPopupOpen=function(t,e){var i=e.sourceEventData;this.scribe("open",e,{items:[{id:i.contentId,item_type:o.tweet}],item_count:1})},this.after("initialize",function(){this.on(document,"dataActivityPopupSuccess",this.scribeActivityPopupOpen)})}var n=i(14),o=i(47),a=i(45);t.exports=n(s,a)},713:function(t,e,i){function s(){this.curateTweets=function(t,e){function i(t){e.added.forEach(function(){this.scribe({component:"tweet",action:"add_to_timeline"},t)}.bind(this));var i="ツイートを削除/追加しました。";this.trigger("uiShowMessage",{message:i}),this.trigger("dataTweetsCurated",t)}function s(t){var e="ツイートの追加/削除に失敗しました。";this.trigger("uiShowError",{message:e})}var n={added:e.added,removed:e.removed,tweet_id:e.tweetId,impression_id:e.impressionId};this.post({url:"/i/curate/batch",data:n,eventData:e,success:i.bind(this),error:s.bind(this)})},this.addTweet=function(t,e){function i(t){var e=_("<a href='{{url}}'>{{name}}</a>にツイートを追加しました",{url:t.timeline_url,name:t.timeline_name});this.trigger("uiShowMessage",{message:e,timeout:1e4}),this.trigger("dataTweetAddedToTimeline",t),this.scribe({component:"tweet",action:"quick_add_to_timeline"},t)}function s(t){this.trigger("uiShowError",t),this.trigger("dataTweetNotAddedToTimeline",t)}var n={timeline_id:e.timelineId,tweet_id:e.tweetId,impression_id:e.impressionId};this.post({url:"/i/curate/add_tweet",data:n,eventData:e,success:i.bind(this),error:s.bind(this)})},this.removeTweet=function(t,e){function i(t){this.trigger("dataTweetRemovedFromTimeline",t),this.trigger("uiShowMessage",{message:"ツイートを削除しました。"}),this.trigger("dataTweetRemovedFromTimeline",t)}function s(t){this.trigger("uiShowError",{message:"ツイートを削除できませんでした。"}),this.trigger("dataTweetNotRemovedFromTimeline",t)}var n={timeline_id:e.timelineId,tweet_id:e.tweetId,id:e.tweetId};this.post({url:"/i/curate/remove_tweet",data:n,eventData:e,success:i.bind(this),error:s.bind(this)})},this.createCustomTimeline=function(t,e){function i(t){this.scribe({component:"custom_timeline",action:"create"},t),this.trigger("uiNavigate",{href:t.timeline_url})}function s(t){this.trigger("uiShowError",{message:"コレクション作成中にエラーが発生しました"})}var n={name:e.name,description:e.description,order:e.order,tweet_id:e.tweetId,impression_id:e.impressionId};this.post({url:"/i/curate/create",data:n,eventData:e,success:i.bind(this),error:s.bind(this)})},this.updateCustomTimeline=function(t,e){function i(t){this.scribe({element:"custom_timeline",action:"update"},t);var e=_("コレクションが更新されました。 <a href='{{url}}'>こちらからご確認ください。</a>",{url:t.timeline_url});this.trigger("uiShowMessage",{message:e,timeout:5e3}),this.trigger("dataCustomTimelineUpdated",t)}function s(t){this.trigger("uiShowError",{message:"コレクションの更新中にエラーが発生しました"})}var n={timeline_id:e.id,name:e.name,description:e.description,order:e.order};this.post({url:"/i/curate/update",data:n,eventData:e,success:i.bind(this),error:s.bind(this)})},this.deleteCustomTimeline=function(t,e){function i(t){this.scribe({element:"custom_timeline",action:"delete"},t),this.trigger("uiNavigate",{href:this.attr.timelines_url})}function s(t){this.trigger("uiShowError",{message:"コレクションの削除中にエラーが発生しました"})}this.post({url:"/i/curate/destroy",data:{timeline_id:e.timeline_id},eventData:e,success:i.bind(this),error:s.bind(this)})},this.getFullCustomTimelines=function(t,e){this.get({url:"/i/curate/all_timelines",eventData:e,data:{tweet_id:e.tweetId},success:"dataGotFullCustomTimelines",error:"dataFailedToGetFullCustomTimelines"})},this.getCustomTimelinesForDropdown=function(t,e){e.tweetId&&this.get({url:"/i/curate/timelines",eventData:e,data:{tweet_id:e.tweetId},success:"dataGotCustomTimelines",error:"dataFailedToGetCustomTimelines"})},this.after("initialize",function(){a.getDecider("custom_timeline_curation")&&(this.on("uiCurateTweets",this.curateTweets),this.on("uiCurateAddTweet",this.addTweet),this.on("uiCurateRemoveTweet",this.removeTweet),this.on("uiNeedsCustomTimelines",this.getCustomTimelinesForDropdown),this.on("uiNeedsFullCustomTimelines",this.getFullCustomTimelines),this.on("uiCreateCustomTimeline",this.createCustomTimeline),this.on("uiUpdateCustomTimeline",this.updateCustomTimeline),this.on("uiDeleteCustomTimeline",this.deleteCustomTimeline))})}var n=i(14),o=i(141),a=i(39),r=i(45),_=i(26),l=n(s,o,r);t.exports=l},714:function(t,e,i){function s(){this.updateMomentMapAndTriggerEvent=function(t){return function(e){this.momentMap=r.merge(this.momentMap,e.moment_map||{}),this.trigger(document,t,e)}.bind(this)},this.getDropdownUserMoments=function(t,e){this.get({url:"/i/moments/list_user_moments/dropdown",data:{tweet_id:e.tweet_id},success:this.updateMomentMapAndTriggerEvent("dataMomentsGetDropdownUserMomentsSuccess"),error:"dataMomentsGetDropdownUserMomentsFailure"})},this.getDialogUserMoments=function(t,e){this.get({url:"/i/moments/list_user_moments/dialog",data:e,success:this.updateMomentMapAndTriggerEvent("dataMomentsGetDialogUserMomentsSuccess"),error:"dataMomentsGetDialogUserMomentsFailure"})},this.addTweetSuccess=function(t,e){var i,s=e.moment_id&&this.momentMap[e.moment_id];s&&(i=s.is_empty_title?_('ツイートを次に追加しました: "<a target="_blank" href="{{url}}">無題のモーメント</a>"',{url:e.moment_maker_url}):_('ツイートを次に追加しました: "<a target="_blank" href="{{url}}">{{moment_name}}</a>"',{url:e.moment_maker_url,moment_name:s.title}),this.trigger("uiShowMessage",{message:i}))},this.removeTweetSuccess=function(t,e){var i,s=e.moment_id&&this.momentMap[e.moment_id];s&&(i=s.is_empty_title?_('ツイートを次から削除しました: "<a target="_blank" href="{{url}}">無題のモーメント</a>"',{url:e.moment_maker_url}):_('ツイートを次から削除しました: "<a target="_blank" href="{{url}}">{{moment_name}}</a>"',{url:e.moment_maker_url,moment_name:s.title}),this.trigger("uiShowMessage",{message:i}))},this.after("initialize",function(){this.momentMap={},this.on("uiMomentsGetDropdownUserMoments",this.getDropdownUserMoments),this.on("uiMomentsGetDialogUserMoments",this.getDialogUserMoments),this.on(document,"dataMomentMakerAddTweetSuccess",this.addTweetSuccess),this.on(document,"dataMomentMakerRemoveTweetSuccess",this.removeTweetSuccess)})}var n=i(14),o=i(141),a=i(45),r=i(29),_=i(26);t.exports=n(s,o,a)},715:function(t,e,i){function s(){this.createActionHandler=function(t,e){return function(i,s){this.post({url:"/i/moments/edit/"+s.moment_id+"/"+t,data:s,success:"dataMomentMaker"+e+"TweetSuccess",error:"dataMomentMaker"+e+"TweetFailure"})}.bind(this)},this.bindAction=function(t){var e=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();this.on("uiMomentMaker"+e+"Tweet",this.createActionHandler(t.toLowerCase(),e))},this.sortMoment=function(t,e){this.post({url:"/i/moments/edit/"+e.moment_id+"/sort",data:e,success:"dataMomentMakerSortMomentSuccess",error:this.genericErrorMessage.bind(this)})},this.editMetaData=function(t,e){this.post({url:"/i/moments/edit/"+e.moment_id+"/meta",data:e,success:"dataMomentMakerEditMetaSuccess",error:"dataMomentMakerEditMetaFailure"})},this.setCoverData=function(t,e){this.post({url:"/i/moments/edit/"+e.moment_id+"/update_cover",data:e,success:"dataMomentMakerSetCoverSuccess",error:"dataMomentMakerSetCoverFailure"})},this.setCoverCropData=function(t,e){this.post({url:"/i/moments/edit/"+e.moment_id+"/update_cover",data:e,success:"dataMomentMakerSetCoverCropSuccess",error:"dataMomentMakerSetCoverCropFailure"})},this.setCoverDataByMediaId=function(t,e){function i(){this.trigger("dataMomentMakerSetCoverFailure")}var s=e.fileId,n=o.get(s);if(n)return this.trigger(document,"uiMediaSruInit",{fileId:s,uploadId:n.uploadId,mediaCategory:n.mediaCategory}),this.mediaSruFinalize(n).then(function(t){this.post({url:"/i/moments/edit/"+e.momentId+"/update_cover/"+t,success:"dataMomentMakerSetCoverSuccess",error:"dataMomentMakerSetCoverFailure"})}.bind(this)).catch(function(t){throw i(),t})},this.createMoment=function(t,e){function i(t){this.trigger("uiNavigate",{href:t.url})}function s(){this.trigger("uiShowError",{message:"問題が発生しました。このモーメントは作成できません。しばらくしてからやりなおしてください。"})}this.post({url:"/i/moments/create",data:e,success:i.bind(this),error:s.bind(this)})},this.deleteMoment=function(t,e){function i(t){this.trigger("dataMomentMakerDeleteMomentSuccess",{href:t.href||"/i/moments"})}this.post({url:"/i/moments/delete",data:e,success:i.bind(this),error:"dataMomentMakerDeleteMomentFailure"})},this.updateCrop=function(t,e){function i(){this.trigger("dataMomentMakerUpdateCropFailure"),this.genericErrorMessage()}this.post({url:"/i/moments/edit/"+e.moment_id+"/update_crop",data:e,success:"dataMomentMakerUpdateCropSuccess",error:i.bind(this)})},this.updateMomentVisibility=function(t,e){function i(t){t&&t.permission_error?this.trigger("uiShowError",{message:"この操作を行う権限がありません。"}):this.trigger("uiMomentMakerUpdateVisibilitySuccess",c.merge(t,e))}function s(){this.trigger("uiMomentMakerUpdateVisibilityError",e),this.genericErrorMessage()}this.post({url:"/i/moments/visibility/"+e.moment_id,data:{mode:e.visibility_mode},success:i.bind(this),error:s.bind(this)})},this.updateNSFWSetting=function(t,e){function i(){this.trigger("uiShowMessage",{message:"モーメントの設定が更新されました。"})}function s(){this.trigger("dataMomentMakerUpdateNSFWError",{previous_value:e.previous_value})}this.post({url:"/i/moments/edit/"+e.moment_id+"/update_nsfw",data:e,success:i.bind(this),error:s.bind(this)})},this.updatePublishLocationSetting=function(t,e){function i(){this.trigger("uiShowMessage",{message:"モーメントの位置情報の設定が更新されました。"})}function s(){this.trigger("dataMomentMakerUpdatePublishLocationError",{previous_value:e.previous_value})}this.post({url:"/i/moments/edit/"+e.moment_id+"/update_publish_location",data:e,success:i.bind(this),error:s.bind(this)})},this.updateThemeColorSetting=function(t,e){function i(){this.trigger("dataMomentMakerUpdateThemeColorError",{previous_value:e.previous_value})}this.post({url:"/i/moments/edit/"+e.moment_id+"/update_theme_color",data:e,success:"dataMomentMakerUpdateThemeColorSuccess",error:i.bind(this)})},this.genericErrorMessage=function(){this.trigger("uiShowError",{message:"問題が発生しました。しばらくしてからやりなおしてください。"})},this.after("initialize",function(){this.bindAction("add"),this.bindAction("remove"),this.bindAction("reorder"),this.on("uiMomentMakerSortMoment",this.sortMoment),this.on("uiMomentMakerEditMeta",this.editMetaData),this.on("uiMomentMakerSetCover",this.setCoverData),this.on("uiMomentMakerSetCoverCrop",this.setCoverCropData),this.on("uiMomentMakerSetCoverByMediaId",this.setCoverDataByMediaId),this.on("uiMomentMakerCreateMoment",this.createMoment),this.on("uiMomentMakerDeleteMoment",this.deleteMoment),this.on("uiMomentMakerUpdateVisibility",this.updateMomentVisibility),this.on("uiMomentMakerUpdateCrop",this.updateCrop),this.on("uiMomentMakerUpdateNSFW",this.updateNSFWSetting),this.on("uiMomentMakerUpdatePublishLocation",this.updatePublishLocationSetting),this.on("uiMomentMakerUpdateThemeColor",this.updateThemeColorSetting)})}var n=i(14),o=i(121),a=i(141),r=i(150),l=i(318),c=i(29);i(26);t.exports=n(s,a,r,l)},716:function(t,e,i){function s(){this.scribeCreateMoment=function(t,e){var i=e&&e.scribeContext&&e.scribeContext.component;this.scribe({component:i,element:"create_moment_button",action:"click"})},this.after("initialize",function(){this.on("uiMomentMakerCreateMoment",this.scribeCreateMoment)})}var n=i(14),o=i(45);t.exports=n(s,o)},717:function(t,e,i){function s(){this.scribeTweetAction=function(t,e,i){var s=i&&i.scribeContext&&i.scribeContext.component;this.scribe({component:s,element:"moment",action:t})},this.after("initialize",function(){this.on("uiMomentMakerAddTweet",this.scribeTweetAction.bind(this,"add")),this.on("uiMomentMakerRemoveTweet",this.scribeTweetAction.bind(this,"remove")),this.on("dataMomentMakerAddTweetFailure",this.scribeTweetAction.bind(this,"add_failure")),this.scribeOnEvent("uiOpenAddToMomentDialog",{component:"add_to_moment_dialog",action:"open"})})}var n=i(14),o=i(45);t.exports=n(s,o)},718:function(t,e,i){function s(){this.defaultAttrs({tweetSelector:".tweet",tweetFormSelector:".tweet-form",conversationModuleSelector:".conversation-module",animatedGifSelector:".animated-gif"})}var n=i(14),o=i(719),a=i(720),r=i(295),l=i(721),c=i(723),h=i(278),d=i(379);t.exports=n(s,a,l,c,r,d,h,o)},719:function(t,e,i){(function(e){var s=i(24),n=i(41);t.exports=function(){s.mixin(this,[n]),this.getPlayableMediaEventData=function(t){var e={},i=t.find("[data-media-id]").attr("data-media-id");if(i)e.playlist_url=i,e.video_uuid=i;else{var s=t.find("[data-card-url]").attr("data-card-url");e.playlist_url=s,e.video_uuid=s}return e.video_type="video",e.card_details=JSON.stringify(e),e},this.logPlayableMediaEvents=function(t,i,s){var n,o=i.attr("data-tweet-id");n="animated_gif"===s||"__entity_animated_gif"===s?"gif_player":"vine_player";var a=e.extend({},this.interactionData(i),this.getPlayableMediaEventData(i));this.eventsFired.view[o]||(this.trigger("uiPlayableMediaEvent",e.extend({name:"video_content_view"},a)),this.scribeInteraction({action:"video_view",element:n},a),this.eventsFired.view[o]=!0),this.eventsFired[t][o]||(this.trigger("uiPlayableMediaEvent",e.extend({name:"video_content_"+t},a)),this.scribeInteraction({action:t,element:n},a),this.eventsFired[t][o]=!0)},this.shouldCollectAnalytics=function(t,e){return"animated_gif"===e||t.data("has-vine")},this.onAutoplayStart=function(t){var i=e(t.target);if(i.length){var s=i.find("[data-card2-name]").attr("data-card2-name");this.shouldCollectAnalytics(i,s)&&(this.autoplayTimeout=setTimeout(function(){this.logPlayableMediaEvents("view_threshold",i,s)}.bind(this),3e3))}},this.onAutoplayStop=function(){this.autoplayTimeout&&clearTimeout(this.autoplayTimeout)},this.onTweetExpanded=function(t){var i=e(t.target);if(i.length){var s=i.find("[data-card2-name]").attr("data-card2-name");this.shouldCollectAnalytics(i,s)&&this.logPlayableMediaEvents("play_from_tap",i,s)}},this.after("initialize",function(){this.eventsFired={view:{},play_from_tap:{},view_threshold:{}},this.on("uiLOHPMediaPlay",this.onTweetExpanded),this.on("uiAutoplayMedia",this.onAutoplayStart),this.on("uiStopAutoplayingMedia",this.onAutoplayStop)})}}).call(e,i(1))},720:function(t,e,i){(function(e){t.exports=function(){this.defaultAttrs({missingTweetsLinkSelector:"a.missing-tweets-link",missingTweetsBarSelector:".missing-tweets-bar",focalTweetSelector:".original-tweet",topLevelStreamItemSelector:".stream-item:not(.conversation-tweet-item)",conversationTweetClass:"conversation-tweet",detachedConversationClass:"detached-conversation",expandingConversationClass:"expanding-conversation",selectedSelector:".selected-stream-item",awaitingAncestorsClass:".conversation-awaiting-ancestors"}),this.handleExpandConversationAndLoadMissingTweets=function(t){t.preventDefault();var e=this.streamItemFromEvent(t),i=this.getFocalPoint(e),s=i.data("permalink-path"),n=i.data("conversation-id");s&&this.trigger("uiNavigate",{href:s,conversation_id:n})},this.streamItemFromEvent=function(t){return e(t.target).closest(this.attr.topLevelStreamItemSelector)},this.getFocalPoint=function(t){return t.find(this.attr.focalTweetSelector)},this.getTweetId=function(t){return e(t).find(".tweet").attr("data-tweet-id")},this.notifyConversationMutated=function(t,i){var s=e(t.target),n=s.closest(this.attr.conversationModuleSelector);n.length&&this.trigger(n,"uiConversationModuleUpdated")},this.after("initialize",function(){this.on("click",{missingTweetsLinkSelector:this.handleExpandConversationAndLoadMissingTweets}),this.on("uiShortcutEnter",{missingTweetsBarSelector:this.handleExpandConversationAndLoadMissingTweets}),this.on("uiTweetInserted uiBeforeTweetRemoved",this.notifyConversationMutated)})}}).call(e,i(1))},721:function(t,e,i){(function(e){function s(){this.getSize=function(t,e){var i=e.attr("data-width"),s=e.attr("data-height"),n=e.width(),o=s*(n/i);return{h:o,w:n}},this.createMediaElement=function(t,e,i){return new MediaElement(t,{pluginPath:n.path,flashName:"flashmediaelement.swf",loop:!0,defaultVideoHeight:e.h,defaultVideoWidth:e.w,pluginHeight:e.h,pluginWidth:e.w,success:i})},this.prepareMediaElement=function(t,e){var i=function(t){this.setCurrentTime(t,0),t.play()}.bind(this),s=this.createMediaElement(t,e,function(t){t.addEventListener("ended",function(){t&&i(t)},!1),t.addEventListener("timeupdate",function(){if("native"===s.pluginType&&t.duration<=t.currentTime){var e=function n(){i(t),t.removeEventListener("loadeddata",n)};t.addEventListener("loadeddata",e),t.load()}},!1),t.play()});return s},this.getPlayer=function(t){if(t.length){var e=t.find(this.attr.animatedGifSelector);if(e.length)return this.players[t.attr("data-tweet-id")]}return null},this.setCurrentTime=function(t,e){"native"===t.pluginType?t.currentTime=e:t.setCurrentTime(e)},this.autoplayGif=function(t){this.startGif(e(t.target).closest(".tweet"))},this.startGifOnEvent=function(t){this.startGif(e(t.target))},this.startGif=function(t){if(t=t.filter(":not(.animated-gif-playing)").has(this.attr.animatedGifSelector),t.length){var e=t.attr("data-tweet-id");if(!this.players[e]){var i=t.find(this.attr.animatedGifSelector),s=i.find("[video-src]");s.attr("src",s.attr("video-src"));var n=i.get(0),o=this.getSize(t,i);this.players[e]=this.prepareMediaElement(n,o),this.players[e].load()}t.addClass("animated-gif-playing"),setTimeout(function(){this.players[e]&&this.players[e].play&&this.players[e].play()}.bind(this),1)}},this.stopAutoplayingGif=function(t){this.stopGif(e(t.target).closest(".tweet"))},this.stopGifOnEvent=function(t){this.stopGif(e(t.target))},this.stopGif=function(t){var e=t.hasClass("animated-gif-playing")&&this.getPlayer(t);e&&(t.removeClass("animated-gif-playing"),t.find(".me-plugin").remove(),e.pause&&e.pause())},this.pauseGif=function(t){var i=e(t.target),s=i.hasClass("animated-gif-playing")&&this.getPlayer(i);s&&s.pause&&s.pause()},this.seekGif=function(t,i){var s=e(t.target),n=s.hasClass("animated-gif-playing")&&this.getPlayer(s);if(n){var o=i.position*n.duration;isNaN(n.duration)||(this.setCurrentTime(n,Math.min(o,n.duration)),n.pause())}},this.after("initialize",function(){this.players={},this.on("uiAutoplayMedia",this.autoplayGif),this.on("uiStartGif",this.startGifOnEvent),this.on("uiStopAutoplayingMedia",this.stopAutoplayingGif),this.on("uiStopGif",this.stopGifOnEvent),this.on("uiPauseGif",this.pauseGif),this.on("uiSeekGif",this.seekGif)})}var n=i(722);t.exports=s}).call(e,i(1))},722:function(t,e){t.exports={path:"/flash/1/"}},723:function(t,e,i){(function(e){var s=i(59).browser(),n=i(24),o=i(41);t.exports=function(){n.mixin(this,[o]),this.defaultAttrs({snapReelVideoSelector:"video.js-snap-reel",easingAcceleration:.5,FPS:s.chrome?20:30}),this.logInteraction=function(t){var e=t.attr("data-tweet-id");this.eventScribed[e]||(this.scribeInteraction({action:"snap_reel_interaction"},this.interactionData(t)),this.eventScribed[e]=!0)},this.mouseOver=function(t){this.video=e(t.target),this.tweet=this.video.parents(this.attr.tweetSelector),this.tweet.hasClass("animated-gif-playing")&&(this.scribeTimeout=setTimeout(function(){this.logInteraction(this.tweet,this.video)}.bind(this),3e3)),this.start()},this.mouseOut=function(t){clearTimeout(this.scribeTimeout),this.tweet&&this.tweet.hasClass("animated-gif-playing")&&(this.tweet.removeClass("animated-gif-playing"),this.trigger(this.tweet,"uiStartGif")),this.stop(),this.scribeTimeout=void 0,this.tweet=void 0,this.targetPosition=void 0},this.mouseMove=function(t){this.tweet&&this.tweet.hasClass("animated-gif-playing")&&(this.targetPosition=t.pageX-this.video.offset().left)},this.start=function(){this.running=!0,this.tick()},this.stop=function(){this.running=!1},this.tick=function(){if(this.running){var t=1e3/this.attr.FPS;setTimeout(function(){requestAnimationFrame(this.tick.bind(this)),this.update()}.bind(this),t)}},this.update=function(){if(this.targetPosition){this.currentPosition+=(this.targetPosition-this.currentPosition)*this.attr.easingAcceleration;var t=this.currentPosition/this.video.width();this.trigger(this.tweet,"uiSeekGif",{position:t})}},this.after("initialize",function(t,e){this.scribeTimeout=void 0,this.eventScribed={},this.currentPosition=0,this.on("mouseover",{snapReelVideoSelector:this.mouseOver}),this.on("mouseout",{snapReelVideoSelector:this.mouseOut}),this.on("mousemove",{snapReelVideoSelector:this.mouseMove})})}}).call(e,i(1))},724:function(t,e,i){function s(){this.deleteMediaTag=function(t,e){var i=function(t){this.trigger("dataMediaTagRemoveSuccess",t)},s=function(t,i,s){this.trigger("dataMediaTagRemoveFailure",{id:e.id,status:i,errorThrown:s})},n={status_id:e.id};this.post({url:"/i/media/media_tags/delete",data:n,eventData:e,success:i.bind(this),error:s.bind(this)})},this.after("initialize",function(){this.on("uiDidRemoveMediaTag",this.deleteMediaTag)})}var n=i(14),o=i(141),a=n(s,o);t.exports=a},725:function(t,e,i){(function(e){function s(){this.defaultAttrs({newItemsBarSelector:".js-new-tweets-bar",containerSelector:".stream-container",newTweetsBarVisibleClass:"new-tweets-bar-visible",scrollTopOnNewItemsClick:!0}),this.updateNewItemsBar=function(t,i){if(t.target.contains(this.node)){var s=e(i.html),n=this.select("newItemsBarSelector");n.length?(n.replaceWith(s),this.trigger("uiNewItemsBarUpdated")):(this.$node.html(s),this.$node.hide(),this.showNewItemsBar(),this.trigger("uiNewItemsBarShown")),this.trigger("uiNewItemsBarVisible")}},this.showNewItemsBar=function(){var t=this.$node.parent(),i=o.getCanvasYOffset(t),s=e(window).scrollTop();this.$node.addClass(this.attr.newTweetsBarVisibleClass),s>i?(this.$node.show(),e("html, body").scrollTop(s+this.$node.height())):this.$node.slideDown()},this.hideNewItemsBar=function(){this.trigger("uiNewItemsBarHidden");var t=this.select("newItemsBarSelector");t.remove(),this.$node.removeClass(this.attr.newTweetsBarVisibleClass)},this.handleNewItemsBarClick=function(t,i){var s=e(t.target).closest("[data-live-video-item-json]").attr("data-live-video-item-json");this.attr.scrollTopOnNewItemsClick&&a(0,"fast"),this.trigger("uiInjectNewItems",{fromClick:!0});var n=e(t.target).attr("data-item-count"),o={unreadCount:Number(n)};if(s)try{o.items=[JSON.parse(s)]}catch(t){}this.trigger("uiNewItemsBarClick",o)},this.after("initialize",function(){this.on(document,"uiUpdateNewItemsBar",this.updateNewItemsBar),this.on(document,"uiHideNewItemsBar",this.hideNewItemsBar),this.on("click",{newItemsBarSelector:this.handleNewItemsBarClick})})}var n=i(14),o=i(80),a=i(726);t.exports=n(s)}).call(e,i(1))},742:function(t,e,i){function s(t){this.defaultAttrs({itemType:"tweet"}),this.scribeActivityCount=function(t,e,i){var s={component:this.attr.itemType,element:t,action:"click"};this.scribe(s,this.interactionData(e))},this.after("initialize",function(){this.on("uiRequestReplyActivity",this.scribeActivityCount.bind(this,"reply_count")),this.on("uiRequestRetweetedActivity",this.scribeActivityCount.bind(this,"retweet_count")),this.on("uiRequestFavoritedActivity",this.scribeActivityCount.bind(this,"favorite_count"))})}var n=i(14),o=i(41),a=i(44),r=n(s,o,a);t.exports=r},743:function(t,e,i){function s(){this.getTweetTranslation=function(t,e){var i=function(e){e&&e.message&&this.trigger("uiShowMessage",{message:e.message}),this.trigger(t.target,"dataTweetTranslationSuccess",e)},s=function(i,s,n){this.trigger(t.target,"dataTweetTranslationError",{id:e.id,status:s,errorThrown:n})},n={id:e.tweetId,dest:e.dest};this.get({url:"/i/translations/show.json",data:n,eventData:e,success:i.bind(this),error:s.bind(this)})},this.submitTweetTranslation=function(t,e){var i=function(e){this.trigger(t.target,"dataTweetTranslationSuggestionSuccess",e)},s=function(i,s,n){this.trigger(t.target,"dataTweetTranslationSuggestionError",{id:e.id,status:s,errorThrown:n})};this.post({url:"/i/translations/suggest.json",data:e,eventData:e,success:i.bind(this),error:s.bind(this)})},this.after("initialize",function(){this.on("uiNeedsTweetTranslation",this.getTweetTranslation),this.on("uiSuggestTweetTranslation",this.submitTweetTranslation)})}var n=i(14),o=i(141),a=n(s,o);t.exports=a},744:function(t,e,i){function s(){}var n=i(14),o=i(745),a=i(344);t.exports=n(s,a,o)},745:function(t,e,i){(function(e){function i(){this.getItemPosition=function(t){return e(this.attr.genericInteractionItemSelector).index(t.closest(this.attr.genericInteractionItemSelector))}}t.exports=i}).call(e,i(1))},746:function(t,e,i){function s(){this.scribeTweetPivotClick=function(t,e){this.scribe({component:"tweet",element:"more",action:"click"},{items:[e.item_details,e.component_details]})},this.after("initialize",function(){this.on("uiTweetPivotClick",this.scribeTweetPivotClick)})}var n=i(14),o=i(45),a=n(s,o);t.exports=a},749:function(t,e,i){var s=i(750),n=i(757),o=i(758),a=i(762),r=i(342),l=i(376),c=i(341),h=i(760),d=i(763),u=i(764),m=i(765),p=s.mixin(n,o,a,r,l,c,h,d,u,m);t.exports=p},758:function(t,e,i){(function(e){function s(){this.injectNewItems=function(t,e){if(!(this.latentItems.length<1)){e&&e.wasPeriodPress&&this.trigger("uiUserPressedPeriodAndSawNewTweets"),e&&e.wasPushStateInjection&&this.trigger("uiUserPushStateInjectedTweets"),e&&e.wasTopBarBirdClick&&this.trigger("uiUserClickedTopBarBirdAndSawNewTweets"),e&&e.wasComposedTweet&&this.trigger("uiUserComposedTweet"),this.trigger("uiHideNewItemsBar");var i=this.injectItems("prepend",this.latentItems.join(""),"uiHasInjectedNewTimeline",e);return this.resetLatentItems(),i}},o.mixin(this,[a,r]),this.defaultAttrs({streamItemSelector:".js-stream-item:not(.js-stream-item .js-stream-item)",refreshOnReturn:!0}),this.getNewItems=function(t,e){var i=Object.keys(this.composedThenInjectedTweetIds);this.trigger("uiWantsMoreTimelineItems",n.merge({include_new_items_bar:!(e&&e.injectImmediately),latent_count:this.latentCount,composed_count:i.length,composed_ids:i},this.getNewItemsData(),this.getNewItemsCountData&&this.getNewItemsCountData(),e))},this.notifyNewItems=function(t){if(t.items_html&&t.items_html.trim()){var e=t.sourceEventData||{};if(this.resetStateVariables(t),t.items_html){if(this.latentItems=this.htmlToItemArray(t.items_html).concat(this.latentItems),this.latentCount=t.new_latent_count,t.new_tweets_bar_html){var i=t.new_tweets_bar_html;this.autoplay?this.autoplayNewItems(t.new_tweets_bar_html):e.injectImmediately||(this.trigger("uiUpdateNewItemsBar",{html:i}),this.trigger("uiAddPageCount",{count:this.latentCount}))}(e.injectImmediately||e.timeline_empty)&&this.trigger("uiInjectNewItems"),e.scrollToTop&&this.scrollToTop(),
e.selectTopTweet&&this.trigger("uiSelectTopTweet")}}},this.htmlToItemArray=function(t){var i=e("<div>").html(t).find(this.attr.streamItemSelector).toArray();return i.map(function(t){return e("<div>").append(t).html()})},this.saveLatentItems=function(t,e){var i=this.select("containerSelector");i.attr("data-latent-items",this.latentItems.join("")),i.attr("data-latent-count",this.latentCount)},this.resetLatentItems=function(){var t=this.select("containerSelector"),e=t.attr("data-latent-items");t.removeAttr("data-latent-items"),this.latentItems=this.htmlToItemArray(e),this.latentCount=parseInt(t.attr("data-latent-count"),10)||0,t.removeAttr("data-latent-count")},this.refreshOnNavigate=function(t,e){e.fromCache&&this.attr.refreshOnReturn&&this.trigger("uiTimelineShouldRefresh",{navigated:!0})},this.refreshAndSelectTopTweet=function(t,e){this.trigger("uiTimelineShouldRefresh",{injectImmediately:!0,selectTopTweet:!0})},this.injectComposedTweet=function(t,i){if(!i.in_reply_to_status_id&&i.tweet_html){this.injectNewItems();var s=e(i.tweet_html).filter(this.attr.streamItemSelector).first().attr("data-item-id");this.$node.find(".original-tweet[data-tweet-id='"+s+"']:first").length||(this.latentItems=this.htmlToItemArray(i.tweet_html),this.injectNewItems(null,{wasComposedTweet:"dataTweetSuccess"===t.type}),this.composedThenInjectedTweetIds[i.tweet_id]=window.location.href)}},this.refreshAndInjectImmediately=function(t,e){this.trigger("uiTimelineShouldRefresh",{injectImmediately:!0,selectTopTweet:1===this.$selected.length})},this.resetCacheOfComposedInjectedTweets=function(t,e){this.composedThenInjectedTweetIds=l={}},this.addPageCount=function(t,e){this.latentCount&&this.trigger("uiAddPageCount",{count:this.latentCount})},this.after("initialize",function(){this.latentItems=[],this.latentCount=0,this.composedThenInjectedTweetIds=l,this.resetLatentItems(),this.injectNewItems(null,{wasPushStateInjection:!0}),this.on("uiInjectNewItems",this.injectNewItems),this.on(document,"uiTimelineShouldRefresh",this.getNewItems),this.on(document,"uiBeforePageChanged",this.saveLatentItems),this.on(document,"uiPageChanged",this.refreshOnNavigate),this.on(document,"uiGotoTopOfScreen",this.refreshAndInjectImmediately),this.on(document,"uiShortcutGotoTopOfScreen",this.refreshAndSelectTopTweet),this.on(document,"dataPageMutated",this.resetCacheOfComposedInjectedTweets),this.on(document,"uiPageNeedsCount",this.addPageCount),this.attr.injectComposedTweets&&this.on(document,"dataTweetSuccess",this.injectComposedTweet)})}var n=i(29),o=i(24),a=i(759),r=i(761),l={};t.exports=s}).call(e,i(1))},759:function(t,e,i){(function(e){function s(){n.mixin(this,[o]);var t=700;this.defaultAttrs({streamItemsSelector:".stream-items",socialProofSelector:".tweet-stats-container"}),this.autoplayNewItems=function(t){if(t){var e=this.$window.scrollTop(),i=e+this.$window.height(),s=this.$promotedItem.length&&this.$promotedItem.offset().top>i,n=this.injectNewItems({},{autoplay:!0}),o=this.select("streamItemsSelector");this.travelingPTw&&s&&this.repositionPromotedItem(function(t){n.first().before(t),n=n.add(t),this.trigger(t,"uiShouldFixMargins")});var a=n.first().offset().top,r=a>e&&a<i,l=o.offset().top,c=n.last().next().offset().top-l+1;r?(o.css("marginTop",-c),this.animateBlockOfItems()):this.setScrollerScrollTop(e+c)}},this.animateBlockOfItems=function(){var e=this.select("streamItemsSelector"),i=this.$window.scrollTop(),s=parseFloat(e.css("marginTop"));e.parent().css("overflow","hidden"),e.animate({marginTop:0},{duration:t+Math.abs(s),step:function(t){this.lockedTimelineScroll&&this.setScrollerScrollTop(i+Math.abs(s-Math.ceil(t)))}.bind(this),complete:function(){e.parent().css("overflow","inherit"),this.afterAnimationQueue.forEach(function(t){t.call(this)},this),this.afterAnimationQueue=[]}.bind(this)})},this.setScrollerScrollTop=function(t){var i=this.attr.overflowScroll?this.$node:e(window);i.scrollTop(t)},this.enableAutoplay=function(){this.autoplay=!0,this.travelingPTw=this.attr.travelingPTw,this.lockedTimelineScroll=!1,this.afterAnimationQueue=[],this.newItemsXLine=0,this.$window=this.attr.overflowScroll?this.$node:e(window),this.on("mouseover",function(){this.lockedTimelineScroll=!0}),this.on("mouseleave",function(){this.lockedTimelineScroll=!1})},this.after("initialize",function(){this.attr.autoplay&&this.enableAutoplay()})}var n=i(24),o=i(760);t.exports=s}).call(e,i(1))},760:function(t,e){function i(){this.repositionPromotedItem=function(t){t.call(this,this.$promotedItem.detach())},this.after("initialize",function(){this.$promotedItem=this.$node.find(".promoted-tweet").first().closest(".stream-item")})}t.exports=i},761:function(t,e,i){(function(e){function s(){this.defaultAttrs({pollingWatchNode:e(window),pollingEnabled:!0}),this.pausePolling=function(){this.pollingTimer.pause(),this.pollingPaused=!0},this.resetPolling=function(){this.backoffEmptyResponseCount=0,this.pollingPaused=!1},this.pollForNewItems=function(t,e){this.trigger("uiTimelineShouldRefresh",{injectImmediately:!1,interval:this.pollingTimer.interval,fromPolling:!0})},this.onGotMoreTimelineItems=function(t,e){if(this.attr.pollingOptions&&this.attr.pollingOptions.pauseAfterBackoff&&e&&e.sourceEventData){if(e.focused_refresh_interval){var i=this.attr.pollingOptions.blurredInterval/this.attr.pollingOptions.focusedInterval;this.pollingTimer.clear(),this.attr.pollingOptions.focusedInterval=e.focused_refresh_interval,this.attr.pollingOptions.blurredInterval=e.focused_refresh_interval*i,this.pollingTimer=n("uiTimelinePollForNewItems",this.attr.pollingWatchNode,this.attr.pollingOptions)}var s=e.sourceEventData;s.fromPolling&&(this.isNewItem(e)||s.interval<this.attr.pollingOptions.blurredInterval?this.resetPolling():++this.backoffEmptyResponseCount>=this.attr.pollingOptions.backoffEmptyResponseLimit&&this.pausePolling())}},this.getNewItemsCountData=function(t){if(this.pollingPaused&&this.attr.pollingOptions)return this.resetPolling(),{count:this.attr.pollingOptions.resumeItemCount}},this.possiblyRefreshBeforeInject=function(t,e,i){return this.pollingPaused&&i&&i.fromClick&&this.trigger("uiTimelineShouldRefresh",{injectImmediately:!0}),t(e,i)},this.around("injectNewItems",this.possiblyRefreshBeforeInject),this.before("teardown",function(){this.pollingTimer&&this.pollingTimer.clear()}),this.after("initialize",function(){this.attr.pollingEnabled&&(this.on(document,"uiTimelinePollForNewItems",this.pollForNewItems),this.on(document,"dataGotMoreTimelineItems",this.onGotMoreTimelineItems),this.pollingTimer=n("uiTimelinePollForNewItems",this.attr.pollingWatchNode,this.attr.pollingOptions),this.resetPolling())})}var n=i(416);t.exports=s}).call(e,i(1))},762:function(t,e,i){(function(e){"use strict";function i(){this.defaultAttrs({viewAllSelector:"button.view-all-supplements",interactionsPageViewAllToggleSelector:".stream-item-activity-notification button.view-all-supplements",additionalStreamItemsSelector:".sub-stream-item-showing, .sub-stream-item-hidden"}),this.toggleInteractionsSupplements=function(t,i){var s=e(i.el),n=s.hasClass("show");this.toggleSupplementTrigger(s,n),this.toggleSubStreamItemsVisibility(s.parent(),n)},this.toggleSupplementTrigger=function(t,e){t.toggleClass("hide",e).toggleClass("show",!e)},this.toggleSubStreamItemsVisibility=function(t,e){t.find(this.attr.additionalStreamItemsSelector).toggleClass("sub-stream-item-hidden",!e).toggleClass("sub-stream-item-showing",e)},this.after("initialize",function(){this.on("click",{interactionsPageViewAllToggleSelector:this.toggleInteractionsSupplements})})}t.exports=i}).call(e,i(1))},763:function(t,e){function i(){this.defaultAttrs({pinnedStreamItemSelector:"li.js-pinned"}),this.keepPinnedStreamItemsOnTop=function(){this.$pinnedStreamItems.length&&(this.$pinnedStreamItems.first().css("margin-top","0"),this.$items.prepend(this.$pinnedStreamItems.detach()))},this.after("initialize",function(){this.$items=this.select("itemsSelector"),this.$pinnedStreamItems=this.select("pinnedStreamItemSelector"),this.on("uiHasInjectedNewTimeline",this.keepPinnedStreamItemsOnTop)})}t.exports=i},764:function(t,e,i){(function(e){i(26);t.exports=function(){this.defaultAttrs({adaptivePhotoContainer:".js-adaptive-photo",adaptiveMediaContainer:".AdaptiveMedia"}),this.getPermalinkPath=function(t){return t.closest(this.attr.streamItemSelector).find(this.attr.permalinkSelector).attr("href")},this.openAdaptiveMediaGallery=function(t,i){t.preventDefault(),t.stopPropagation();var s=e(t.target).closest(this.attr.adaptivePhotoContainer);this.trigger(t.target,"uiOpenGallery",{title:"画像",timelineSelector:this.attr.adaptiveMediaContainer,inOverlay:this.attr.inOverlay});var n=s.closest("[data-impression-id]");n.length&&(n.attr("data-embedded-media-logged",!0),this.trigger("uiEmbeddedMedia",{impressionId:n.data("impression-id"),disclosureType:n.data("disclosure-type")})),i&&i.skipClickScribe||this.trigger("uiMediaThumbnailClick",{url:s.attr("data-image-url"),mediaType:"photo"})},this.openSelectedTweetAdaptiveMediaGallery=function(t){this.trigger(e(t.target).find(this.attr.adaptivePhotoContainer),"uiKeyboardOpenAdaptiveGallery",{skipClickScribe:!0})},this.after("initialize",function(){this.on(document,"uiOpenSelectedPhoto",this.openSelectedTweetAdaptiveMediaGallery),this.on("click uiKeyboardOpenAdaptiveGallery",{adaptivePhotoContainer:this.openAdaptiveMediaGallery})})}}).call(e,i(1))},765:function(t,e){function i(){this.updateYouFollow=function(t,e){this.$node.find("[data-user-id="+t+"][data-you-follow]").attr("data-you-follow",e)},this.updateYouBlock=function(t,e){this.$node.find("[data-user-id="+t+"][data-you-block]").attr("data-you-block",e)},this.setViewerFollowState=function(t){return function(e,i){this.updateYouFollow(i.userId,t)}},this.setViewerBlockState=function(t){return function(e,i){this.updateYouBlock(i.userId,t)}},this.onFollowStateChange=function(t,e){var i=e.userId,s=e.newState;"following"===s?(this.updateYouFollow(i,!0),this.updateYouBlock(i,!1)):"not-following"===s?(this.updateYouFollow(i,!1),this.updateYouBlock(i,!1)):"blocked"===s&&(this.updateYouFollow(i,!1),this.updateYouBlock(i,!0))},this.after("initialize",function(){this.on(document,"uiFollowAction",this.setViewerFollowState(!0)),this.on(document,"uiUnfollowAction uiBlockAction uiReportSpamAction uiDidTriggerBlockingAction",this.setViewerFollowState(!1)),this.on(document,"uiBlockAction uiReportSpamAction uiDidTriggerBlockingAction",this.setViewerBlockState(!0)),this.on(document,"dataFollowStateChange",this.onFollowStateChange)})}t.exports=i},792:function(t,e,i){(function(e){var s=i(31),n=i(94),o=i(794),a=i(1475),r=i(817),l=i(795);t.exports=function(t){s(t),n(t),e('.front-signin input[name="session[username_or_email]"]').focus(),t.passwordResetAdvancedLoginForm&&o.attachTo(".js-front-signin"),a.attachTo(document,t),"input"!==document.activeElement.tagName.toLowerCase()&&e(".front-signin .email-input").focus(),r.attachTo("#front-no-cookies-warn"),l.attachTo(".js-front-signin")}}).call(e,i(1))},793:function(t,e,i){(function(e){var s=i(31),n=i(94),o=i(794),a=(i(26),i(795));t.exports=function(t){s(t),n(t),t.passwordResetAdvancedLoginForm&&o.attachTo(".signin-wrapper"),e("#login-signup-link").click(function(t){e(document).trigger("uiSignupLinkClicked")}),e(".signin-wrapper").data("login-message")&&e(document).trigger("uiShowMessage",{message:"ログインしてください"}),e(".js-username-field").focus(),a.attachTo(".signin-wrapper")}}).call(e,i(1))},796:function(t,e,i){(function(e){var s=i(797),n=i(807),o=i(80),a=i(816),r=i(817),l=i(14),c=i(818),h=i(795),d=i(819),u=i(820),m=i(404),p=i(414),f=i(821),g=i(822),v=i(823),w=i(679),S=i(824),C=i(424),T=i(29),b=i(825),y=i(341),M=l(y);t.exports=function(t){var i=".AppContent",l="#timeline";s(t),n(T.merge(t,{containerSelector:".Grid.TweetForwardTimeline",endpoint:t.timeline_url,excludeExpandingTweets:!0,excludeUserActions:!0,itemType:"tweet",lastItemSelector:".tweet:last",pollingEnabled:!1,scrollTopOnNewItemsClick:!1})),C({loggedIn:t.loggedIn}),v.attachTo(document),r.attachTo("#front-no-cookies-warn"),h.attachTo(".js-StreamsTopBarSignIn"),f.attachTo(".StreamsTopBar",{scrollThreshold:e(".StreamsTopBar").offset().top}),f.attachTo(".StreamsTopBar-container",{scrollThreshold:10,fixedClass:"StreamsTopBar-container--collapsedHero"}),g.attachTo(".StreamsFooter"),p.attachTo(".StreamsCategoryBar, .StreamsCategoryMoreOverlay",{eventData:{scribeContext:{component:"category_bar"}}});var y={itemType:"tweet",noTeardown:!0,loggedIn:t.loggedIn,eventData:{scribeContext:{component:"gallery"}}};w.attachTo(l,t,y),m.attachTo(".Gallery",t,y),m.attachTo(i,t),b.attachTo(i,T.merge(t,{eventData:{scribeContext:{component:"tweet"}}})),M.attachTo(l,T.merge(t,{itemType:"tweet"})),d.attachTo(l,{tweetSelector:".tweet",mediaPreviewContainerSelector:".js-media-preview"}),u.attachTo(document,t),c.attachTo(".TweetForwardTimeline"),a.attachTo(document),S.attachTo(l),o.setGlobalNavSelector(".StreamsTopBar")}}).call(e,i(1))},797:function(t,e,i){var s=i(94),n=i(64),o=i(37),a=i(294),r=i(798),l=i(794),c=i(799),h=i(414),d=i(374),u=i(380),m=i(78),p=i(286),f=i(660),g=i(800),v=i(679),w=i(703),S=i(801),C=i(802),T=i(39),b=i(408),y=i(402),M=i(803),k=i(806),I=i(29);t.exports=function(t){t.loggedIn||s(t),n(t),u.attachTo(document,{noTeardown:!0}),w.attachTo("#uz_streams_survey");var e={itemType:"tweet",noTeardown:!0,loggedIn:t.loggedIn,eventData:{scribeContext:{component:"gallery"}}};if(d.attachTo(".Gallery",t,e),v.attachTo(".Gallery",t,e),o.scribeData.context=t.streamId,c.attachTo(".js-session"),t.passwordResetAdvancedLoginForm&&l.attachTo(".js-front-signin"),C.attachTo(".StreamsHero-buttonContainer, .StreamsTopBar"),f.attachTo(document),S.attachTo(".SignupCallOut"),g.attachTo(document,{autoStart:!0,scrollDelay:10}),a.attachTo(window,{containerSelector:"#timeline",unloadedCardsFilter:'[data-has-autoplayable-media="true"]'}),b.attachTo(document),T.getDecider("moments_lohp_enabled")){var i=".Streams-momentsContainer";y.attachTo(i),M.attachTo(i),k.attachTo(document),h.attachTo(".Streams-momentsContainer",{eventData:{scribeContext:{component:"moments"}}})}m.attachTo(".StreamsLiveVideoModule",t),h.attachTo(".StreamsLiveVideoModule",{eventData:{scribeContext:{component:"live_video_logged_out"},scribeData:{items:[{id:t.liveVideoEventId,item_type:28}]}}}),r.attachTo(".StreamsLiveVideoModule",I.merge(t,{hideOnCookiesError:".StreamsLiveVideoModule-overlay"})),p.attachTo("#timeline",{liveVideoContinuePlayingBehindModals:t.liveVideoContinuePlayingBehindModals})}},798:function(t,e,i){"use strict";function s(){this.defaultAttrs({hideOnCookiesError:void 0,hideOnGeoblockError:void 0,playerSelector:".PlayableMedia-player",ignoreFineGrainGeoblockingData:"data-ignore-fine-grain-geoblocking"}),this.onCookiesError=function(){this.$elementToHideOnCookiesError.length&&this.$elementToHideOnCookiesError.hide()},this.onGeoblockError=function(){var t=this.select("playerSelector").attr(this.attr.ignoreFineGrainGeoblockingData),e=this.select("hideOnGeoblockError");t&&e.length&&e.hide()},this.after("initialize",function(){this.$elementToHideOnCookiesError=this.select("hideOnCookiesError"),this.on("uiPlayableMediaNoCookiesError",this.onCookiesError),this.on("uiPlayableMediaGeoblockError",this.onGeoblockError)})}var n=i(14);t.exports=n(s)},800:function(t,e,i){(function(e){function s(){this.attributes({autoStart:!1,scrollDelay:0,scrollDelta:0}),this.$element=null,this.active=!1,this.frameID=null,this.lastClientHeight=null,this.lastResizeEvent=null,this.lastScrollEvent=null,this.lastScrollTop=null,this.retryScroll=null,this.cancelPendingFrame=function(){this.frameID&&(cancelAnimationFrame(this.frameID),this.frameID=null)},this.frame=function(t){t||(t={}),this.frameID=null,null==t.clientHeight&&(t.clientHeight=this.lastClientHeight||0),null==t.direction&&(t.direction=0),null==t.distance&&(t.distance=0),null==t.scrollTop&&(t.scrollTop=this.scrollTop());var e=t.eventName||"uiElementHasScrolled";delete t.eventName,this.trigger(e,t)},this.clientHeight=function(){return this.$element.height()},this.handleNativeScroll=function(){var t=this.scrollDelay();if(this.retryScroll&&(clearTimeout(this.retryScroll),this.retryScroll=null),!this.validScrollDelay(t))return this.retryScroll=setTimeout(this.trigger.bind(this,"scroll"),this.attr.scrollDelay-t),void this.cancelPendingFrame();var e=this.scrollTop(),i=this.scrollDistance(e);if(this.validScrollDistance(i)){var s=this.scrollDirection(e);this.lastScrollEvent=Date.now(),this.lastScrollTop=e,this.cancelPendingFrame(),this.requestFrame({direction:s,distance:i,scrollTop:e})}},this.handleNativeResize=function(){this.validResizeDelay()&&(this.lastClientHeight=this.clientHeight(),this.lastResizeEvent=Date.now(),this.cancelPendingFrame(),this.requestFrame({direction:0,distance:0,scrollTop:this.lastScrollTop}))},this.resetState=function(){this.frameID=null,this.lastClientHeight=null,this.lastResizeEvent=null,this.lastScrollEvent=null,this.lastScrollTop=null},this.requestInitialFrame=function(){this.lastClientHeight=this.clientHeight(),this.requestFrame({eventName:"uiScrollMonitorStarted"})},this.requestFrame=function(t){this.frameID=requestAnimationFrame(this.frame.bind(this,t))},this.scrollDirection=function(t){return this.lastScrollTop?this.lastScrollTop>t?-1:this.lastScrollTop<t?1:0:t?1:0},this.eventDelay=function(t){return t?Date.now()-t:-1},this.resizeDelay=function(){return this.eventDelay(this.lastResizeEvent)},this.scrollDelay=function(){return this.eventDelay(this.lastScrollEvent)},this.scrollDistance=function(t){return Math.abs(t-(this.lastScrollTop||0))},this.scrollTop=function(){return this.$element.scrollTop()},this.start=function(){this.active||(this.active=!0,this.requestInitialFrame(),this.on(this.$element,"scroll",this.handleNativeScroll),this.on(window,"resize",this.handleNativeResize))},this.stop=function(t,e){this.active&&(e||(e={}),this.active=!1,this.off(this.$element,"scroll",this.handleNativeScroll),this.off(window,"resize",this.handleNativeResize),e.cancelPending&&this.cancelPendingFrame())},this.validResizeDelay=function(t){return this.validEventDelay(t,this.attr.scrollDelay)},this.validScrollDelay=function(t){return this.validEventDelay(t,this.attr.scrollDelay)},this.validEventDelay=function(t,e){return e>0?!(t>-1)||t>=e:0===e},this.validScrollDistance=function(t){return 0===this.attr.scrollDelta||t>=this.attr.scrollDelta},this.after("initialize",function(t){this.on("uiScrollMonitorStart",this.start),this.on("uiScrollMonitorStop",this.stop),this.$element=e(t===window?document:t),this.attr.autoStart&&this.trigger("uiScrollMonitorStart")})}var n=i(14);t.exports=n(s)}).call(e,i(1))},801:function(t,e,i){function s(){this.defaultAttrs({expandButtonSelector:".SignupCallOut-expand",formSelector:".SignupForm"}),this.expandForm=function(){this.select("formSelector").slideDown(),this.select("expandButtonSelector").slideUp(),this.scribe({element:"signup_call_out_expand",action:"click"})},this.after("initialize",function(t){this.on("click",{expandButtonSelector:this.expandForm})})}var n=i(14),o=i(45);t.exports=n(s,o)},802:function(t,e,i){function s(){this.defaultAttrs({loginButtonSelector:".js-login"}),this.loginClicked=function(t,e){t.preventDefault(),this.trigger("uiOpenLoginDialog")},this.after("initialize",function(){this.on("click",{loginButtonSelector:this.loginClicked})})}var n=i(14);t.exports=n(s)},803:function(t,e,i){(function(e){function s(){this.defaultAttrs({itemSelector:".MomentCapsuleSummary",ctaSelector:".MomentCallToAction",defaultLinkSelector:".js-default-link"}),this.onCapsuleClick=function(t,i){if(this.isValidClickTarget(t)){var s=e(i.el).closest(this.attr.itemSelector),n=s.find(this.attr.defaultLinkSelector);this.trigger("uiMomentClicked",this.getMomentScribeInfo(n)),this.trigger("uiNavigate",{href:n.attr("href")})}},this.onDefaultLinkClick=function(t,i){var s=e(t.target);this.trigger("uiMomentClicked",this.getMomentScribeInfo(s))},this.onCtaClick=function(t){var i=e(t.target);this.trigger("uiMomentCtaClicked",this.getMomentScribeInfo(i))},this.isValidClickTarget=function(t){return 0===e(t.target).closest("a, button").length},this.after("initialize",function(){this.on("click",{itemSelector:this.onCapsuleClick,defaultLinkSelector:this.onDefaultLinkClick,ctaSelector:this.onCtaClick})})}var n=i(14),o=i(804);t.exports=n(s,o)}).call(e,i(1))},804:function(t,e,i){function s(){this.getMomentScribeData=function(t){var e={impression_id:o.getClosestAttr(t,"data-guide-impression-id")},i={guide_category_id:o.getClosestAttr(t,"data-guide-category-id")},s={moment_id:o.getClosestAttr(t,"data-moment-id")},a={navigation_uri:o.getClosestAttr(t,"href")},r={visibility:o.getClosestAttr(t,"data-moment-visibility")};return o.scribeData(n.merge(e,i,s,a,r))},this.getMomentScribeInfo=function(t){return{scribeData:this.getMomentScribeData(t),scribeContext:{component:o.getClosestAttr(t,"data-component-context"),element:o.getClosestAttr(t,"data-element-context")}}}}var n=i(29),o=i(805);t.exports=s},805:function(t,e,i){(function(e){var i={scribeData:function(t){return{items:[{moments_details:t}]}},getClosestAttr:function(t,e){return t.closest("["+e+"]").attr(e)},getMomentMakerTopBarVisibility:function(){return e(".MomentMakerTopBar").attr("data-visibility-mode")}};t.exports=i}).call(e,i(1))},806:function(t,e,i){function s(){this.after("initialize",function(){this.scribeOnEvent("uiMomentClicked",{action:"click"}),this.scribeOnEvent("uiMomentCtaClicked",{action:"click"}),this.scribeOnEvent("uiFollowMoment",{action:"follow"}),this.scribeOnEvent("uiUnfollowMoment",{action:"unfollow"}),this.scribeOnEvent("uiLikeMoment",{action:"like"}),this.scribeOnEvent("uiUnlikeMoment",{action:"unlike"})})}var n=i(14),o=i(45);t.exports=n(s,o)},807:function(t,e,i){function s(t){n(t),o("#timeline",t),r.mixin.apply(this,[a]).attachTo("#timeline",t)}var n=i(705),o=i(708),a=i(808),r=i(809);t.exports=s},808:function(t,e,i){(function(e){function i(){this.defaultAttrs({columnContainer:".Grid-cell",columnCount:3,alignmentDelta:500}),this.getItemsToInject=function(t){return t.children().children()},this.injectToDOM=function(t,i){for(var s=0;s<this.attr.columnCount;s++)this.columnSelector(s).append(e(i[s]).children());for(s=0;s<this.attr.fetchedItemsCount;s++){var n=this.getMinMaxColumns(),o=n.min,a=n.max;if(a.height-o.height<this.attr.alignmentDelta)break;this.moveItemOver(a.index,o.index)}},this.columnSelector=function(t){return e(this.attr.columnContainer+":eq("+t+")")},this.getMinMaxColumns=function(){for(var t,e=t={index:0,height:this.columnSelector(0).height()},i=1;i<this.attr.columnCount;i++){var s=this.columnSelector(i).height();s<e.height&&(e={index:i,height:s}),s>t.height&&(t={index:i,height:s})}return{min:e,max:t}},this.moveItemOver=function(t,e){var i=this.columnSelector(t).children(),s=i.last();i.remove(s),this.columnSelector(e).append(s)}}t.exports=i}).call(e,i(1))},809:function(t,e,i){function s(){this.defaultAttrs({itemType:"tweet"})}var n=i(749),o=i(766),a=i(810),r=i(811),l=i(814),c=i(815);t.exports=n.mixin(s,o,r,l,c,a)},810:function(t,e,i){(function(e){t.exports=function(){this.removeSeparatedModule=function(t){var i=e(t.target);this.trigger(i,"uiRemoveClassBeforePromptbird"),i.remove()},this.after("initialize",function(){this.on(document,"uiRemoveSeparatedModule",this.removeSeparatedModule)})}}).call(e,i(1))},811:function(t,e,i){(function(e){var s=i(24),n=i(812);t.exports=function(){s.mixin(this,[n]),this.defaultAttrs({conversationModuleSelector:".conversation-module",hasConversationModuleSelector:".tweet.has-conversation-module",conversationHeaderSelector:".conversation-header",uncollapseSelector:"a.uncollapse",conversationRootSelector:"li.conversation-root",repliesCountSelector:".replies-count",otherRepliesSelector:".other-replies",topLevelStreamItemSelector:".stream-item:not(.conversation-tweet-item)",repliesCountClass:"replies-count",visuallyHiddenClass:"visuallyhidden",conversationRootClass:"conversation-root",conversationTweetsSelector:".conversation-tweet-item,.original-tweet-item",conversationFirstVisibleTweetClass:"conversation-first-visible-tweet",originalTweetClass:"original-tweet",conversationItemsSelector:".conversation-header, .conversation-tweet-item, .original-tweet-item, .missing-tweets-bar",toBeRemovedClass:"to-be-removed",unselectableStreamItemClass:"js-unselectable-stream-item",firstNavigableStreamItemClass:"first-navigable-stream-item",lastNavigableStreamItemClass:"last-navigable-stream-item",collapsedRootClass:"collapsed-root",collapsedAncestorsClass:"collapsed-ancestors",restoreConversationDelay:100,collapseOverMinimum:20}),this.dedupAndCollapse=function(t,e){this.dedupConversations(),this.collapseConversationTweets(e&&e.tweets)},this.dedupAndCollapseNew=function(t,e){this.dedupConversations(),e&&e.tweets&&e.tweets.length<=this.attr.collapseOverMinimum?this.collapseFirstConversationTweets(this.attr.collapseOverMinimum):this.collapseConversationTweets(e&&e.tweets)},this.dedupConversations=function(){var t=this.select("conversationModuleSelector");t.each(function(t,i){if(i.parentNode){var s=e(i).attr("data-ancestors").split(","),n=this.$node.find(this.idsToSelector(s)).filter(function(t,i){return!e(i).parent().hasClass("recap-module")});n.find(this.attr.conversationModuleSelector).addClass(this.attr.toBeRemovedClass);var o=this;n.slideUp({queue:!1,duration:"fast",complete:function(){var t=e(this);t.hasClass(o.attr.selectedClass)&&o.trigger("uiSelectNext",{maintainPosition:!0}),requestAnimationFrame(function(){o.trigger(t,"uiWillRemoveStreamItem"),t.remove()})}})}}.bind(this))},this.idToSelector=function(t){return this.attr.topLevelStreamItemSelector+"#stream-item-tweet-"+t},this.idsToSelector=function(t){return t.map(this.idToSelector.bind(this)).join(",")},this.collapseFirstConversationTweets=function(t){var e=this.$node.find(this.attr.streamItemSelector).slice(0,t).find(this.attr.conversationModuleSelector);this.collapseConversations(e)},this.collapseConversationTweets=function(t){var e;if(t){var i=t.map(function(t){return t.tweetId}),s=this.$node.find(this.idsToSelector(i));e=s.find(this.attr.conversationModuleSelector)}else e=this.select("conversationModuleSelector");this.collapseConversations(e)},this.collapseConversations=function(t){var i={},s={};t.get().reverse().forEach(function(t){var n=e(t),o=n.attr("data-ancestors"),a=n.find(".conversation-root .tweet").attr("data-item-id");n.hasClass("dont-collapse")||(i[o]?this.collapseAncestors(n):s[a]&&this.collapseRoot(n)),n.hasClass(this.attr.toBeRemovedClass)||(i[o]=!0,s[a]=!0)}.bind(this))},this.uncollapseConversationHandler=function(t,e){t.preventDefault();var i=this.conversationModuleFromEvent(t);this.uncollapseConversation(i),i.addClass("dont-collapse")},this.uncollapseConversation=function(t){t.find(".conversation-tweet-item.conversation-ancestor:visible").length>0?this.expandRoot(t):this.expandAncestors(t)},this.setSelectionToRoot=function(t){this.trigger(t.find(".conversation-root.conversation-tweet-item"),"uiSelectItem",{setFocus:!0})},this.expandAncestors=function(t){var e=t.find(this.attr.conversationHeaderSelector),i=t.find(".conversation-tweet-item, .missing-tweets-bar"),s=t.find(".original-tweet-item");this.slideAndFadeContent(e,i,s,function(){t.removeClass(this.attr.collapsedAncestorsClass).removeClass(this.attr.collapsedRootClass),this.setSelectionToRoot(t)}.bind(this))},this.expandRoot=function(t){var e=t.find(this.attr.conversationHeaderSelector),i=t.find(".conversation-tweet-item.conversation-root, .missing-tweets-bar"),s=t.find(".conversation-tweet-item.conversation-ancestor:not(.conversation-root):first");0===s.length&&(s=t.find(".original-tweet-item")),this.slideAndFadeContent(e,i,s,function(){this.setSelectionToRoot(t),t.removeClass(this.attr.collapsedAncestorsClass).removeClass(this.attr.collapsedRootClass)}.bind(this))},this.collapseAncestors=function(t){var e=t.find(".conversation-tweet-item, .missing-tweets-bar"),i=t.find(this.attr.conversationHeaderSelector),s=t.find(".original-tweet-item");this.slideAndFadeContent(e,i,s),t.addClass(this.attr.collapsedAncestorsClass)},this.collapseRoot=function(t){var e=t.find(".conversation-tweet-item.conversation-root, .missing-tweets-bar"),i=t.find(this.attr.conversationHeaderSelector),s=t.find(".conversation-tweet-item.conversation-ancestor:not(.conversation-root):first");0===s.length&&(s=t.find(".original-tweet-item")),this.slideAndFadeContent(e,i,s),1===t.find(".conversation-tweet-item").length?t.addClass(this.attr.collapsedAncestorsClass):t.addClass(this.attr.collapsedRootClass)},this.updateConversationItemClasses=function(t){var i=e(t.target),s=i.find(this.attr.conversationItemsSelector);s.removeClass(this.attr.unselectableStreamItemClass),s.removeClass(this.attr.firstNavigableStreamItemClass),s.removeClass(this.attr.lastNavigableStreamItemClass),s.filter(":hidden").addClass(this.attr.unselectableStreamItemClass);var n=s.filter(":visible");n.first().addClass(this.attr.firstNavigableStreamItemClass),n.last().addClass(this.attr.lastNavigableStreamItemClass),i.find(this.attr.conversationTweetsSelector).removeClass(this.attr.conversationFirstVisibleTweetClass).filter(":visible").first().addClass(this.attr.conversationFirstVisibleTweetClass)},this.conversationModuleFromEvent=function(t){return e(t.target).closest(this.attr.conversationModuleSelector)},this.after("initialize",function(){this.on(document,"uiHasInjectedOldTimelineItems",this.dedupAndCollapse),this.on(document,"uiHasInjectedNewTimeline",this.dedupAndCollapseNew),this.on("click",{uncollapseSelector:this.uncollapseConversationHandler}),this.on("uiShortcutEnter",{conversationHeaderSelector:this.uncollapseConversationHandler}),this.on("uiUncollapseConversation",this.uncollapseConversationHandler),this.on("uiConversationModuleUpdated",this.updateConversationItemClasses),this.dedupAndCollapse()})}}).call(e,i(1))},812:function(t,e,i){(function(e){function s(){this.defaultAttrs({animationTime:200}),this.slideAndFadeContent=function(t,e,i,s){if(!t.is(":hidden")){var o=this.getCombinedHeight(t);t.hide(),e.show();var a=this.getCombinedHeight(e);this.setAbsolutePosition(e),e.hide(),t.show(),this.setAbsolutePosition(t),i.css("paddingTop",o),t.fadeOut(n(this.attr.animationTime)),e.fadeIn(n(this.attr.animationTime)),i.animate({paddingTop:a},n(this.attr.animationTime),function(){this.resetCss(t),this.resetCss(e),this.resetCss(i),this.trigger(i.closest(this.attr.conversationModuleSelector),"uiConversationModuleUpdated"),s&&s()}.bind(this))}},this.getCombinedHeight=function(t){var i=0;return t.each(function(){i+=e(this).outerHeight()}),i},this.setAbsolutePosition=function(t){t.get().reverse().forEach(function(t){var i=e(t),s=i.width(),n=i.height();i.css({position:"absolute",top:i.position().top}),i.width(s),i.height(n)})},this.resetCss=function(t){var e={position:"",top:"",width:"",height:"",paddingTop:""};t.css(e)}}var n=i(813);t.exports=s}).call(e,i(1))},813:function(t,e,i){var s=i(148);t.exports=function(t){var e=s.fromQuery(location).multiplier,i=window.DEBUG.multiplier||e||1;return t*i}},814:function(t,e,i){(function(e){var s=i(24),n=i(812);t.exports=function(){s.mixin(this,[n]),this.defaultAttrs({unchosenActionClass:"unchosen-action",dismissedModuleClass:"dismissed",dismissibleSelector:".dismissible-content",dismissModuleSelector:".dismiss-module",feedbackActionClickSelector:".dropdown .action-prompt",feedbackActionSelector:".dismiss-module .feedback-action",undoActionSelector:".dismissed-module .undo-action"}),this.getStreamItemFromEvent=function(t){return e(t.target).closest(this.attr.topLevelStreamItemSelector)},this.getSuggestionInfoFromStreamItem=function(t){var e=t.attr("data-suggestion-json");return e&&JSON.parse(e)},this.suggestionFeedback=function(t,e,i){var s=this.getSuggestionInfoFromStreamItem(t),n=e.attr("data-feedback-type");this.trigger("uiSuggestionFeedback",{suggestionInfo:s,feedbackType:n,undo:i})},this.selectAction=function(t,i){var s=e(t.target).closest(this.attr.feedbackActionClickSelector),n=s.attr("data-feedback-type"),o=this.getStreamItemFromEvent(t);
o.addClass(this.attr.dismissedModuleClass),this.slideAndFadeContent(o.find(this.attr.dismissibleSelector),o.find(this.attr.dismissModuleSelector),o);var a=o.find(this.attr.feedbackActionSelector);a.each(function(t,i){var s=e(i);s.toggleClass(this.attr.unchosenActionClass,s.attr("data-feedback-type")!==n)}.bind(this)),this.suggestionFeedback(o,s,!1)},this.undoSelectAction=function(t,i){var s=e(t.target).closest(this.attr.feedbackActionSelector),n=this.getStreamItemFromEvent(t);n.removeClass(this.attr.dismissedModuleClass),this.slideAndFadeContent(n.find(this.attr.dismissModuleSelector),n.find(this.attr.dismissibleSelector),n),n.find(this.attr.feedbackActionSelector).removeClass(this.attr.unchosenActionClass),this.suggestionFeedback(n,s,!0)},this.after("initialize",function(){this.on("click",{feedbackActionClickSelector:this.selectAction,undoActionSelector:this.undoSelectAction})})}}).call(e,i(1))},815:function(t,e,i){(function(e){var s=i(45),n=i(24);t.exports=function(){n.mixin(this,[s]),this.defaultAttrs({messageStreamItemSelector:".MessageStreamItem",dismissButtonSelector:".MessageStreamItem .Icon--close.js-dismiss",dismissSelector:".MessageStreamItem .js-dismiss",primaryActionSelector:".MessageStreamItem .js-primary-action",secondaryActionSelector:".MessageStreamItem .js-secondary-action"}),this.dismissMessage=function(t){this.scribe({component:this.getScribeComponent(t),action:"dismiss"});var e=this.getStreamItem(t);e.fadeOut(function(){e.remove()})},this.scribeDismissButton=function(t){this.scribeClick(t,"dismiss")},this.scribePrimaryAction=function(t){this.scribeClick(t,"primary_action")},this.scribeSecondaryAction=function(t){this.scribeClick(t,"secondary_action")},this.scribeClick=function(t,e){this.scribe({component:this.getScribeComponent(t),element:e,action:"click"})},this.getScribeComponent=function(t){var e=this.getStreamItem(t);return e.attr("data-component-context")},this.getStreamItem=function(t){return e(t.target).closest(this.attr.messageStreamItemSelector)},this.after("initialize",function(){this.on("click",{dismissButtonSelector:this.scribeDismissButton,dismissSelector:this.dismissMessage,primaryActionSelector:this.scribePrimaryAction,secondaryActionSelector:this.scribeSecondaryAction})})}}).call(e,i(1))},816:function(t,e,i){function s(){this.defaultAttrs({searchItemSelector:".StreamsCategoryBar-item.ItemSearch",searchBarSelector:".StreamsTopBar-searchContainer",searchDismissSelector:".StreamsTopBar-searchDismiss",searchHiddenClass:"StreamsTopBar-searchContainerHidden",categoryBarSelector:".StreamsCategoryBar",scribeComponent:"category_bar",scribeElement:"search"}),this.showSearch=function(){this.scribe({component:this.attr.scribeComponent,element:this.attr.scribeElement,action:"show"}),this.select("categoryBarSelector").addClass("u-hidden"),this.select("categoryBarSelector").addClass("StreamsTopBar--invisible"),this.select("searchBarSelector").removeClass("u-hidden"),setTimeout(function(){this.select("searchBarSelector").removeClass("StreamsTopBar--invisible")}.bind(this))},this.hideSearch=function(){this.scribe({component:this.attr.scribeComponent,element:this.attr.scribeElement,action:"hide"}),this.select("searchBarSelector").addClass("u-hidden"),this.select("searchBarSelector").addClass("StreamsTopBar--invisible"),this.select("categoryBarSelector").removeClass("u-hidden"),setTimeout(function(){this.select("categoryBarSelector").removeClass("StreamsTopBar--invisible")}.bind(this))},this.after("initialize",function(){this.on("click",{searchItemSelector:this.showSearch,searchDismissSelector:this.hideSearch})})}var n=i(14),o=i(244),a=i(45);t.exports=n(o,a,s)},817:function(t,e,i){function s(){this.cookiesEnabled=function(){return!!navigator.cookieEnabled},this.showWarning=function(){this.cookiesEnabled()||this.$node.show("fast")},this.after("initialize",function(){this.on(document,"uiSwiftLoaded",this.showWarning)})}var n=i(14);t.exports=n(s)},818:function(t,e,i){(function(e){function s(){this.defaultAttrs({tweetSelector:".js-stream-tweet",mediaGifSelector:".js-media-preview",animatedGifSelector:".animated-gif"}),this.handleGifClick=function(t,i){var s=e(i.el).closest(this.attr.tweetSelector),n=s.find(this.attr.mediaGifSelector);n.hasClass("is-playing")?(this.trigger(s,"uiStopGif"),n.removeClass("is-playing")):(this.trigger(s,"uiStartGif"),n.addClass("is-playing"))},this.after("initialize",function(){this.on("click",{mediaGifSelector:this.handleGifClick,animatedGifSelector:this.handleGifClick})})}var n=i(721),o=i(14);t.exports=o(s,n)}).call(e,i(1))},819:function(t,e,i){(function(e){function s(){this.defaultAttrs({tweetSelector:".js-tweet",mediaPreviewSelector:".js-media-preview"}),this.loadCard=function(t,i){var s=e(i.el).closest(this.attr.tweetSelector);this.createCard(s)},this.once=function(t){return function(i,s){var n=e(s.el);n.data("clicked")||(n.data("clicked",!0),t.call(this,i,s))}.bind(this)},this.after("initialize",function(t,e){this.on("click",{mediaPreviewSelector:this.once(this.loadCard)})})}var n=i(14),o=i(295);t.exports=n(s,o)}).call(e,i(1))},820:function(t,e,i){function s(){var t=/:[A-Z0-9_-]+$/i;this.scribeMediaThumbnailResults=function(e,i){var s=i.thumbnails.length,n=s?"results":"no_results",o={};s&&(o.items=i.thumbnails.map(function(e){return{name:e.replace(t,"")}})),this.scribe({action:n},i,o)},this.scribeMediaThumbnailClick=function(e,i){var s={url:i.url&&i.url.replace(t,"")},n={element:i.mediaType,action:"click"};this.scribe(n,i,s)},this.scribeMediaViewAllClick=function(t,e){this.scribe({action:"view_all"},e)},this.after("initialize",function(){this.on(document,"uiMediaGalleryResults",this.scribeMediaThumbnailResults),this.on(document,"uiMediaThumbnailsVisible",this.scribeMediaThumbnailResults),this.on(document,"uiMediaThumbnailClick",this.scribeMediaThumbnailClick),this.on(document,"uiMediaViewAllClick",this.scribeMediaViewAllClick)})}var n=i(14),o=i(45);t.exports=n(s,o)},821:function(t,e,i){(function(e){function s(){this.defaultAttrs({fixedClass:"StreamsTopBar--fixed",scrollThreshold:300}),this.handleScroll=function(t,e){!this.isFixed&&e.scrollTop>=this.attr.scrollThreshold?(this.$node.addClass(this.attr.fixedClass),this.isFixed=!0):this.isFixed&&e.scrollTop<this.attr.scrollThreshold&&(this.$node.removeClass(this.attr.fixedClass),this.isFixed=!1)},this.after("initialize",function(){this.isFixed=!1,this.handleScroll(null,{scrollTop:e(document).scrollTop()}),this.on(document,"uiElementHasScrolled",this.handleScroll)})}var n=i(14);t.exports=n(s)}).call(e,i(1))},822:function(t,e,i){(function(e){function s(){this.defaultAttrs({fixedClass:"StreamsFooter--fixed",slideClass:"StreamsFooter--slide"}),this.isOnScreen=function(t){var i=e(window).scrollTop(),s=e(t).offset().top;return s<e(window).height()+i&&s>i-e(t).height()},this.scrolledToBottom=function(){return this.isOnScreen(".btn-link.back-to-top")||this.isOnScreen(".js-stream-whale-end")},this.handleScroll=function(t,e){this.$node.addClass(this.attr.slideClass),this.isFooterShown||e.direction!==-1&&!this.scrolledToBottom()?this.isFooterShown&&1===e.direction&&!this.scrolledToBottom()&&(this.$node.removeClass(this.attr.fixedClass),this.isFooterShown=!1):(this.scrolledToBottom()&&this.$node.removeClass(this.attr.slideClass),this.$node.addClass(this.attr.fixedClass),this.isFooterShown=!0)},this.after("initialize",function(){this.isFooterShown=!0,this.on(document,"uiElementHasScrolled",this.handleScroll),this.on(document,"uiHasInjectedOldTimelineItems",this.handleScroll)})}var n=i(14);t.exports=n(s)}).call(e,i(1))},823:function(t,e,i){function s(){this.defaultAttrs({signinEmailInputSelector:".js-signin-email"}),this.after("initialize",function(){"input"!==this.node.activeElement.tagName.toLowerCase()&&this.select("signinEmailInputSelector").focus()})}var n=i(14);t.exports=n(s)},824:function(t,e,i){(function(e){function s(){this.defaultAttrs({moduleSelector:".TweetWithPivotModule",pivotSelector:".TweetWithPivotModule-header a",tweetItemSelector:".tweet",itemType:"tweet",exculdesSelector:"a, .AdaptiveMedia, button"}),this.isDropdownOpen=function(){return e(document).find(".dropdown-menu:visible").length>0},this.handlePivotClick=function(t,i,s){this.scribeModuleClick(e(t.target),"pivot")},this.handleTweetClick=function(t,i,s){var n=e(t.target),o=n.closest(this.attr.moduleSelector),a=e(i.el);t.isDefaultPrevented()||0!==n.closest(this.attr.exculdesSelector).length||this.isDropdownOpen()||!a.data("permalink-path")||(s.position=n.closest("[data-module-position]").data("module-position"),this.triggerTweetAction("uiPermalinkClick").apply(this,arguments),this.scribeModuleClick(n,"tweet"),a.trigger("uiNavigate",{href:o.data("tweet-click-path")||a.data("permalink-path"),conversation_id:a.data("conversation-id")}))},this.scribeModuleClick=function(t,i){var s=t.closest(this.attr.moduleSelector),n=s.find(this.attr.tweetItemSelector),o=s.data("scribe-context"),a=this.getModulePosition(s),r={event_info:o.type,items:[{id:n.attr("data-tweet-id"),item_type:"tweet",position:a}],targets:[{id:o.id,name:o.name,item_type:"stream",position:a}]};e(document).trigger("scribe",{scribeEvent:{component:"module_"+o.type,element:i,action:"click"},scribeData:r}),e(document).trigger("scribe",{scribeEvent:{component:"module_"+a,element:i,action:"click"},scribeData:r})},this.getModulePosition=function(t){return e(this.select("moduleSelector").sort(function(t,i){var s=e(t).position(),n=e(i).position();return Math.abs(s.top-n.top)<=100?s.left-n.left:s.top-n.top})).index(t)},this.after("initialize",function(){this.on(document,"uiCardLoaded uiStartGif","uiLOHPMediaPlay"),this.on("click",{pivotSelector:this.handlePivotClick,tweetItemSelector:this.composeHandler(this.getClosestTweet,this.mkTweetDataCollectorForAction(this.interactionDataWithCard),this.handleTweetClick)})})}var n=i(14),o=i(719),a=i(348),r=i(41);t.exports=n(s,o,a,r)}).call(e,i(1))},825:function(t,e,i){var s=i(14),n=i(764);t.exports=s(n)},1475:function(t,e,i){(function(e){function s(){this.scribeFrontpageLink=function(t,i){var s=t.target.className;"signup-welcome-link"===s?this.scribe({component:"lifeline",element:"welcome_text",action:"signup_click"}):s.indexOf("app-store")!==-1?this.scribe({page:"front",section:"front",component:"download",element:"ios",action:"click"}):s.indexOf("google-play")!==-1?this.scribe({page:"front",section:"front",component:"download",element:"android",action:"click"}):e(t.target).parent().hasClass("devices-link")?this.scribe({page:"front",section:"front",component:"download",element:"other",action:"click"}):s.indexOf("tweet-text")!==-1?this.scribe({page:"front",section:"front",component:"tweet",element:"lohp_tweet_text",action:"click"}):s.indexOf("tweet-username")!==-1?this.scribe({page:"front",section:"front",component:"tweet",element:"lohp_tweet_username",action:"click"}):s.indexOf("tweet-time")!==-1&&this.scribe({page:"front",section:"front",component:"tweet",element:"lohp_tweet_time",action:"click"})},this.after("initialize",function(){this.on("click",this.scribeFrontpageLink)})}var n=i(14),o=i(45);t.exports=n(s,o)}).call(e,i(1))}});
//# sourceMappingURL=7.pages_front.ja.3a7a22f7a023c16076db.js.map